import{t as k,a as u,b as M}from"../chunks/DV0htR0b.js";import{i as K}from"../chunks/DvLNuc85.js";import{q as N,r as z,b as a,v as Q,w as c,i as t,m as p,x as o,y as i,z as P}from"../chunks/DCkLJiGP.js";import{e as W,s as T}from"../chunks/DeRr3rea.js";import{i as x,b as X}from"../chunks/Bug4azAl.js";import{b as C,r as O}from"../chunks/yRR4lMfm.js";import{s as Y,a as Z}from"../chunks/BC_43_Lu.js";import{s as ee,g as se}from"../chunks/DeUlJPgJ.js";import{o as ae}from"../chunks/DzGvXcqd.js";const te=()=>{const l=ee;return{page:{subscribe:l.page.subscribe},navigating:{subscribe:l.navigating.subscribe},updated:l.updated}},re={subscribe(l){return te().page.subscribe(l)}};var oe=k('<p class="success-message svelte-193izyl"> </p>'),ie=k('<p class="error-message svelte-193izyl"> </p>'),le=k('<div class="auth-page-container svelte-193izyl"><div class="auth-box svelte-193izyl"><header class="auth-header svelte-193izyl">로그인</header> <!> <form class="auth-form svelte-193izyl"><div class="form-group svelte-193izyl"><label for="username" class="svelte-193izyl">사용자 이름</label> <input type="text" id="username" required placeholder="사용자 이름 입력" class="svelte-193izyl"></div> <div class="form-group svelte-193izyl"><label for="password" class="svelte-193izyl">비밀번호</label> <input type="password" id="password" required placeholder="비밀번호 입력" class="svelte-193izyl"></div> <!> <button type="submit" class="submit-button svelte-193izyl"><!></button></form> <div class="link-section svelte-193izyl">계정이 없으신가요? <a href="/signup" class="svelte-193izyl">회원가입</a></div></div> <footer class="auth-footer svelte-193izyl">Velt Chat - 로그인</footer></div>');function he(l,$){N($,!1);const[R,V]=Y(),A=()=>Z(re,"$page",R);let d=p(""),m=p(""),n=p(""),v=p(""),f=p(!1),g=p();async function B(e){if(e.preventDefault(),!a(d)||!a(m)){t(n,"사용자 이름과 비밀번호를 입력해주세요."),t(v,"");return}t(n,""),t(v,""),t(f,!0);try{const s=new URLSearchParams;s.append("username",a(d)),s.append("password",a(m));const r=await fetch("/api/auth/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s});if(!r.ok){let D={detail:"로그인 실패. 사용자 이름 또는 비밀번호를 확인하세요."};try{D=await r.json()}catch{}throw t(n,D.detail||`오류 발생: ${r.status}`),new Error(a(n))}const j=await r.json();if(j.access_token)localStorage.setItem("authToken",j.access_token),await se("/");else throw new Error("토큰이 수신되지 않았습니다.")}catch(s){console.error("Login failed:",s),t(n,s.message||"로그인 중 오류가 발생했습니다.")}finally{t(f,!1)}}ae(()=>{A().url.searchParams.get("signedUp")&&t(v,"회원가입이 완료되었습니다! 이제 로그인하세요.");const s=a(g).querySelector("input");s==null||s.focus()}),K();var h=le(),S=o(h),q=c(o(S),2);{var F=e=>{var s=oe(),r=o(s,!0);i(s),z(()=>T(r,a(v))),u(e,s)};x(q,e=>{a(v)&&e(F)})}var b=c(q,2),y=o(b),E=c(o(y),2);O(E),i(y);var _=c(y,2),L=c(o(_),2);O(L),i(_);var U=c(_,2);{var G=e=>{var s=ie(),r=o(s,!0);i(s),z(()=>T(r,a(n))),u(e,s)};x(U,e=>{a(n)&&e(G)})}var w=c(U,2),H=o(w);{var I=e=>{var s=M("처리 중...");u(e,s)},J=e=>{var s=M("로그인");u(e,s)};x(H,e=>{a(f)?e(I):e(J,!1)})}i(w),i(b),X(b,e=>t(g,e),()=>a(g)),P(2),i(S),P(2),i(h),z(()=>w.disabled=a(f)),C(E,()=>a(d),e=>t(d,e)),C(L,()=>a(m),e=>t(m,e)),W("submit",b,B),u(l,h),Q(),V()}export{he as component};
